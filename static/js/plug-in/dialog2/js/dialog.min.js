!function(t,n,o,e){"use strict";var i=function(){function e(n,o){this.$element=t(n),this.settings=t.extend({},t.fn.dialog.defaults,o)}return e.prototype={_init:function(){var t=this;clearTimeout(t.autoCloseTimer),t.isHided=!1,t.tapBug=t._hasTapBug(),t.platform=a.platform,t.dislogStyle="default"===t.settings.style?t.platform:t.settings.style,t._renderDOM(),t._bindEvents()},_renderDOM:function(){var t=this;t.settings.onBeforeShow(),t._createDialogDOM(t.settings.type),t.settings.onShow()},_bindEvents:function(){var e=this;e.$confirmBtn.on(a.tapEvent,function(t){e.closeDialog(),e.settings.onClickConfirmBtn()}).on("touchend",function(t){t.preventDefault()}),e.$cancelBtn.on(a.tapEvent,function(t){e.closeDialog(),e.settings.onClickCancelBtn()}).on("touchend",function(t){t.preventDefault()}),e.$closeBtn.on(a.tapEvent,function(t){e.closeDialog(),e.settings.onClickCloseBtn()}).on("touchend",function(t){t.preventDefault()}),e.settings.overlayClose&&t(o).on(a.tapEvent,".dialog-overlay",function(t){e.closeDialog()}),e.settings.autoClose>0&&(console.log(e.settings.autoClose/1e3+"秒后, 自动关闭弹窗"),e._autoClose()),t(o).on("webkitAnimationEnd MSAnimationEnd animationend",".dialog-content",function(){e.isHided&&(e.removeDialog(),e.tapBug&&e._removeTapOverlayer())}),e.settings.buttons.length&&t.each(e.settings.buttons,function(t,n){e.$dialogContentFt.children("button").eq(t).on(a.tapEvent,function(t){e.closeDialog(),n.callback(),t.preventDefault()})}),t(n).on("onorientationchange"in n?"orientationchange":"resize",function(){e.settings.contentScroll&&setTimeout(function(){e._resetDialog()},200)}),t(o).on("touchmove",function(n){return!e.$dialog.find(t(n.target)).length}),e.settings.contentScroll&&e._contentScrollEvent(),"android"===e.dislogStyle&&t(".dialog-content-ft > .dialog-btn").ripple()},_createDialogDOM:function(n){var o=this;switch(o.$dialog=t('<div class="dialog dialog-open '+o.settings.dialogClass+'" data-style="'+o.dislogStyle+'"></div>'),o.$dialogOverlay=t('<div class="dialog-overlay"></div>'),o.$dialogContent=t('<div class="dialog-content"></div>'),o.$dialogTitle=t('<div class="dialog-content-hd"><h3 class="dialog-content-title">'+o.settings.titleText+"</h3></div>"),o.$dialogContentFt=t('<div class="dialog-content-ft"></div>'),o.$dialogContentBd=t('<div class="dialog-content-bd"></div>'),o.$closeBtn=t('<div class="dialog-btn-close"><span>close</span></div>'),o.$confirmBtn=t('<button class="dialog-btn dialog-btn-confirm '+o.settings.buttonClassConfirm+'">'+o.settings.buttonTextConfirm+"</button>"),o.$cancelBtn=t('<button class="dialog-btn dialog-btn-cancel '+o.settings.buttonClassCancel+'">'+o.settings.buttonTextCancel+"</button>"),n){case"alert":o.$dialog.addClass("dialog-modal"),o.settings.overlayShow&&o.$dialog.append(o.$dialogOverlay),o.settings.titleShow&&o.$dialogContent.append(o.$dialogTitle),o.settings.closeBtnShow&&o.$dialogTitle.append(o.$closeBtn),o.$dialogContentBd.html(o.settings.content),o.$dialogContentFt.append(o.$confirmBtn),o.$dialogContent.append(o.$dialogContentBd).append(o.$dialogContentFt),o.$dialog.append(o.$dialogContent),t("body").append(o.$dialog),o.settings.contentScroll&&o._setDialogContentHeight();break;case"confirm":if(o.$dialog.addClass("dialog-modal"),o.settings.overlayShow&&o.$dialog.append(o.$dialogOverlay),o.settings.titleShow&&o.$dialogContent.append(o.$dialogTitle),o.settings.closeBtnShow&&o.$dialogTitle.append(o.$closeBtn),o.settings.buttons.length){var e="";t.each(o.settings.buttons,function(t,n){e+='<button class="dialog-btn '+n.class+'">'+n.name+"</button>"}),o.$dialogContentFt.append(e).addClass(o.settings.buttonStyle)}else o.$dialogContentFt.append(o.$cancelBtn).append(o.$confirmBtn).addClass(o.settings.buttonStyle);o.$dialogContentBd.html(o.settings.content),o.$dialogContent.append(o.$dialogContentBd).append(o.$dialogContentFt),o.$dialog.append(o.$dialogContent),t("body").append(o.$dialog),o.settings.contentScroll&&o._setDialogContentHeight();break;case"toast":o.$dialog.addClass("dialog-toast"),o.settings.overlayShow&&o.$dialog.append(o.$dialogOverlay);var i=t(o.settings.content);""!==o.settings.infoIcon&&""!==o.settings.infoText?i=t('<img class="info-icon" src="'+o.settings.infoIcon+'" /><span class="info-text">'+o.settings.infoText+"</span>"):""===o.settings.infoIcon&&""!==o.settings.infoText?i=t('<span class="info-text">'+o.settings.infoText+"</span>"):""!==o.settings.infoIcon&&""===o.settings.infoText&&(i=t('<img class="info-icon" src="'+o.settings.infoIcon+'" />')),o.$dialogContentBd.append(i),o.$dialogContent.append(o.$dialogContentBd),o.$dialog.append(o.$dialogContent),t("body").append(o.$dialog);break;case"notice":o.$dialog.addClass("dialog-notice"),"bottom"===o.settings.position&&o.$dialog.addClass("dialog-notice-bottom"),o.settings.overlayShow&&o.$dialog.append(o.$dialogOverlay);var a=t(o.settings.content);""!==o.settings.infoIcon&&""!==o.settings.infoText?a=t('<img class="info-icon" src="'+o.settings.infoIcon+'" /><span class="info-text">'+o.settings.infoText+"</span>"):""===o.settings.infoIcon&&""!==o.settings.infoText?a=t('<span class="info-text">'+o.settings.infoText+"</span>"):""!==o.settings.infoIcon&&""===o.settings.infoText&&(a=t('<img class="info-icon" src="'+o.settings.infoIcon+'" />')),o.$dialogContentBd.append(a),o.$dialogContent.append(o.$dialogContentBd),o.$dialog.append(o.$dialogContent),t("body").append(o.$dialog);break;default:console.log("running default")}},_setDialogContentHeight:function(){var t=this;setTimeout(function(){var n=t.$dialogContentBd.height(),o=t._getDialogContentMaxHeight();t.$dialogContentBd.css({"max-height":o}).addClass("content-scroll"),n>o?t.$dialogContentFt.addClass("dialog-content-ft-border"):t.$dialogContentFt.removeClass("dialog-content-ft-border")},80)},_getDialogContentMaxHeight:function(){var o=this,e=t(n).height(),i=o.$dialogTitle.height(),a=o.$dialogContentFt.height(),s=e-i-a-60;return s=s%2==0?s:s-1},_resetDialog:function(){this._setDialogContentHeight()},_contentScrollEvent:function(){var n=!1,e={x:0,y:0,top:0,left:0};t(o).on("touchstart mousedown",".content-scroll",function(o){var i=o.changedTouches?o.changedTouches[0]:o;return n=!0,e.x=i.clientX,e.y=i.clientY,e.top=t(this).scrollTop(),e.left=t(this).scrollLeft(),!1}).on("touchmove mousemove",".content-scroll",function(o){var i=o.changedTouches?o.changedTouches[0]:o;if(!n)return!1;var a=e.top-(i.clientY-e.y),s=e.left-(i.clientX-e.x);t(this).scrollTop(a).scrollLeft(s)}).on("touchend mouseup",".content-scroll",function(t){t.preventDefault(),n=!1})},_autoClose:function(){var t=this;t.autoCloseTimer=setTimeout(function(){t.closeDialog()},t.settings.autoClose)},closeDialog:function(){var t=this;t.isHided=!0,t.settings.onBeforeClosed(),t.$dialog.addClass("dialog-close").removeClass("dialog-open"),t.tapBug&&t._appendTapOverlayer()},removeDialog:function(){var n=this;n.$dialog.remove(),n.isHided=!1,n.settings.onClosed(),n.settings=t.fn.dialog.defaults},update:function(n){var o=this;clearTimeout(o.autoCloseTimer),o.settings=t.extend({},t.fn.dialog.defaults,n),""!==o.settings.content&&o.$dialogContentBd.html(o.settings.content);var e=o.$dialogContentBd.find(".info-icon"),i=o.$dialogContentBd.find(".info-text");e.attr({src:o.settings.infoIcon}),i.html(o.settings.infoText),o._bindEvents()},_hasTapBug:function(){return a.isAndroid&&a.version<4.4},_appendTapOverlayer:function(){var n=this;n.$tapBugOverlayer=t(".solve-tap-bug"),n.$tapBugOverlayer.length||(n.$tapBugOverlayer=t('<div class="solve-tap-bug" style="margin:0;padding:0;border:0;background:rgba(0,0,0,0);-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;height:100%;position:fixed;top:0;left:0;"></div>'),t("body").append(n.$tapBugOverlayer))},_removeTapOverlayer:function(){var t=this;setTimeout(function(){t.$tapBugOverlayer.remove()},350)}},e}(),a=function(t){var n=t.navigator.userAgent,e=/android|adr/gi.test(n),i=/iphone|ipod|ipad/gi.test(n)&&!e,a=e||i,s=i?"ios":e?"android":"default",l="ontouchend"in o,d=i?/os [\d._]*/gi:/android [\d._]*/gi,g=n.match(d),c=(g+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,".");return{isIOS:i,isAndroid:e,isMobile:a,platform:s,version:parseFloat(c),isSupportTouch:l,tapEvent:a&&l?"tapEvent":"click"}}(n);t.fn.dialog=function(o){var e=this;return this.each(function(){var a=t(this),s=n.jQuery?a.data("dialog"):t.fn.dialog.lookup[a.data("dialog")];if(!s){var l=new i(this,o);l._init(),n.jQuery?a.data("dialog",l):(t.fn.dialog.lookup[++t.fn.dialog.lookup.i]=l,a.data("dialog",t.fn.dialog.lookup.i),s=t.fn.dialog.lookup[a.data("dialog")])}"string"==typeof o&&s[o](),e.close=function(){l.closeDialog()},e.update=function(t){l.update(t)}})},n.jQuery||(t.fn.dialog.lookup={i:0}),t.fn.dialog.defaults={type:"alert",style:"default",titleShow:!0,titleText:"提示",closeBtnShow:!1,content:"",contentScroll:!0,dialogClass:"",autoClose:0,overlayShow:!0,overlayClose:!1,buttonStyle:"side",buttonTextConfirm:"确定",buttonTextCancel:"取消",buttonClassConfirm:"",buttonClassCancel:"",buttons:[],infoIcon:"",infoText:"",position:"center",onClickConfirmBtn:function(){},onClickCancelBtn:function(){},onClickCloseBtn:function(){},onBeforeShow:function(){},onShow:function(){},onBeforeClosed:function(){},onClosed:function(){}}}(window.jQuery||window.Zepto,window,document);